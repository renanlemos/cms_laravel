$app.controller('ModuloPosicaoController',function($scope,$resource,AuthService,CSRF_TOKEN){$scope.title="Módulo Posição";$scope.window={new:function(){$scope.dataItem={descricao:""};$scope.formView="new";$scope.formAction="create()";$scope.modal.setOptions({title:"Adicionar Módulo"});$scope.modal.open().center();},edit:function(dataItem){$scope.formView="edit";$scope.formAction="update()";$scope.modal.setOptions({title:"Editar Módulo: "+dataItem.id});$scope.modal.open().center();$scope.dataItem=dataItem;},close:function(){$scope.modal.close();}}
$scope.executeAction=function(action){switch(action){case"create()":create();break;case"update()":update();break;}}
create=function(){if(AuthService.checkCreate("modulo-posicao")&&AuthService.checkCreate("modulos")){var request=$resource("/admin/modulo-posicaos",{_token:CSRF_TOKEN});$scope.loaderForm=true;request.save($scope.dataItem,function(response){switch(response.status){case 0:return displayErrors(response.data);break;case 1:alert(response.data);$scope.dataItem={descricao:""};$scope.grid.dataSource.read();$scope.loaderForm=false;break;case 2:alert(response.data);$scope.loaderForm=false;break;}},function(response){$scope.loaderForm=false;});}}
update=function(){if(AuthService.checkUpdate("modulo-posicao")&&AuthService.checkUpdate("modulos")){var request=$resource("/admin/modulo-posicaos",{_token:CSRF_TOKEN},{update:{method:"PUT"}});$scope.loaderForm=true;request.update($scope.dataItem,function(response){switch(response.status){case 0:return displayErrors(response.data);break;case 1:alert(response.data);$scope.grid.dataSource.read();$scope.loaderForm=false;break;case 2:alert(response.data);$scope.loaderForm=false;break;}},function(response){$scope.loaderForm=false;});}}
$scope.delete=function(dataItem){if(AuthService.checkDelete("modulo-posicao")&&AuthService.checkDelete("modulos")){if(confirm("Deseja deletar esse(s) registro(s)?")){var ids=[];var type="single";var id=dataItem.id;if(dataItem=="multiple"){if($(".itemGrid:checked").length==0){alert("Nenhum item marcado.");return false;}
$(".itemGrid:checked").map(function(key,value){ids.push(value.value);});type="multiple";id=ids[0];}
var request=$resource("/admin/modulo-posicaos");$scope.loaderForm=true;request.delete({id:id,ids:[ids],type:type,_token:CSRF_TOKEN},function(response){switch(response.status){case 2:alert(response.data);$scope.loaderForm=false;break;default:if(type=="multiple"){displayMessagesArray(response.data);}else{alert(response.data);}
$scope.grid.dataSource.read();$scope.loaderForm=false;break;}},function(response){alert("Error: "+response.data);$scope.loaderForm=false;});}}}
displayMessagesArray=function(data){var messages="";angular.forEach(data,function(value,key){messages+=value+"\n";});alert(messages);}
displayErrors=function(errors){var messages="";angular.forEach(errors,function(value,key){if(value.length>1){angular.forEach(value,function(value,key){messages+=value+"\n";});}else{messages+=value+"\n";}});alert(messages);$scope.loaderForm=false;}
optionsGrid=function(){return $scope.optionsGrid={dataSource:{type:"json",transport:{read:'/admin/modulo-posicaos/grid'},serpageSize:10,serverPaging:true,serverFiltering:true,serverSorting:true,schema:{data:"data",total:"total",model:{id:"id",fields:{id:{type:"number"}}}}},sortable:true,reorderable:true,resizable:true,mobile:true,selectable:true,groupable:{messages:{empty:"Arraste uma coluna para agrupar"}},pageable:{refresh:true,pageSize:10,pageSizes:true,messages:{display:"{0} - {1} de {2} itens",empty:"Não Existem Itens para mostrar",page:"Página",of:"de {0}",itemsPerPage:"itens por Página",first:"Primeira Página",previous:"Página Anterior",next:"Próxima Página",last:"Última Página",refresh:"Atualizar",}},filterable:{extra:true,messages:{clear:"Limpar",filter:"buscar",info:"Registros que:",and:"e",or:"ou",selectValue:"Selecione",},operators:{string:{startswith:"Começa com",endswith:"Termina com",eq:"Seja igual a",neq:"Não é igual a",contains:"Contém",doesnotcontain:"Não contém",},date:{eq:"Igual a",gte:"Maior ou igual a",gt:"Maior que",lte:"Menor ou igual a",lt:"Menor que"},number:{eq:"Igual a",gte:"Maior ou igual a",gt:"Maior que",lte:"Menor ou igual a",lt:"Menor que"},enums:{eq:"Seja igual a",neq:"Não é igual a"}}},toolbar:[{template:"<button class='k-button' ng-disabled='access_create == false' ng-click='window.new()'><span class='k-icon k-i-plus' style='padding:0 2px 0 0;'></span></button>"},{template:"<button class='k-button' ng-click='delete(\"multiple\")'><span class='k-icon k-i-close' style='padding:0 2px 0 0;'></span></button>"}],columns:[{title:"<input type='checkbox' ng-model='checkAll' />",width:"30px",template:"<input type='checkbox' class='itemGrid' ng-model='itensGrid' ng-value='dataItem.id' ng-checked='checkAll'/>",filterable:false,sortable:false},{field:"id",title:"Id",type:"number",width:"50px"},{field:"descricao",title:"Descrição",type:"string"},{command:[{template:"<button class=\'k-button\' ng-disabled='access_update == false' ng-click=\'window.edit(dataItem)\'><span class='k-icon k-i-pencil' style='padding:0 2px 0 0;'></span></button>"},{template:"<button  class=\'k-button\' ng-disabled='access_destroy == false' ng-click=\'delete(dataItem)\'><span class='k-icon k-i-close' style='padding:0 2px 0 0;'></span></button>"}]}]}}
optionsModal=function(){$scope.conf_modal={title:'Módulo Html',width:'400',height:'150',actions:["Minimize","Maximize","Close"],visible:false,modal:true,resizable:true,animation:{close:{duration:200},open:{duration:200}}}}
init=function(){AuthService.checkView("modulos");AuthService.checkView("modulo-posicao");optionsModal();optionsGrid();}
init();});$app.controller('ModuloHtmlController',function($scope,$rootScope,$resource,AuthService,ListDataService,CSRF_TOKEN){$scope.title="Módulo Html";$scope.window={new:function(){$scope.dataItem={titulo:"",apelido:"",tipo:"html",modulo_posicao_id:"",publicado:true,mostrar_titulo:0,tag_titulo:"h1",conteudo:"",parametros:{class:"",id:""},ordem:""};$scope.mostrar_titulo="";$scope.formView="new";$scope.formAction="create()";$scope.modal.setOptions({title:"Adicionar Módulo"});$scope.modal.open().center();},edit:function(dataItem){$scope.formView="edit";$scope.formAction="update()";$scope.modal.setOptions({title:"Editar Módulo: "+dataItem.id});$scope.modal.open().center();$scope.dataItem=dataItem;$scope.dataItem.parametros=angular.fromJson(dataItem.parametros);if(dataItem.mostrar_titulo==true){$scope.dataItem.mostrar_titulo=1;}
if(dataItem.mostrar_titulo==false){$scope.dataItem.mostrar_titulo=0;}},ordem:function(dataItem){$scope.dataItem=dataItem;$scope.modal_ordem.open().center();},close:function(){$scope.modal.close();},close_ordem:function(){$scope.modal_ordem.close();}}
$scope.executeAction=function(action){switch(action){case"create()":create();break;case"update()":update();break;}}
create=function(){if(AuthService.checkCreate("modulo-html")&&AuthService.checkCreate("modulos")){var request=$resource("/admin/modulos",{_token:CSRF_TOKEN});$scope.loaderForm=true;''
request.save($scope.dataItem,function(response){switch(response.status){case 0:return displayErrors(response.data);break;case 1:alert(response.data);$scope.dataItem={titulo:"",apelido:"",tipo:"html",modulo_posicao_id:"",publicado:true,mostrar_titulo:0,tag_titulo:"h1",conteudo:"",parametros:{class:"",id:""},ordem:""};$scope.grid.dataSource.read();$scope.loaderForm=false;break;case 2:alert(response.data);$scope.loaderForm=false;break;}},function(response){$scope.loaderForm=false;});}}
update=function(){if(AuthService.checkUpdate("modulo-html")&&AuthService.checkUpdate("modulos")){var request=$resource("/admin/modulos",{_token:CSRF_TOKEN},{update:{method:"PUT"}});$scope.loaderForm=true;request.update($scope.dataItem,function(response){switch(response.status){case 0:return displayErrors(response.data);break;case 1:alert(response.data);$scope.grid.dataSource.read();$scope.loaderForm=false;break;case 2:alert(response.data);$scope.loaderForm=false;break;}},function(response){$scope.loaderForm=false;});}}
$scope.delete=function(dataItem){if(AuthService.checkDelete("modulo-html")&&AuthService.checkDelete("modulos")){if(confirm("Deseja deletar esse(s) registro(s)?")){var ids=[];var type="single";var id=dataItem.id;if(dataItem=="multiple"){if($(".itemGrid:checked").length==0){alert("Nenhum item marcado.");return false;}
$(".itemGrid:checked").map(function(key,value){ids.push(value.value);});type="multiple";id=ids[0];}
var request=$resource("/admin/modulos");$scope.loaderForm=true;request.delete({id:id,ids:[ids],type:type,_token:CSRF_TOKEN},function(response){switch(response.status){case 2:alert(response.data);$scope.loaderForm=false;break;default:if(type=="multiple"){displayMessagesArray(response.data);}else{alert(response.data);}
$scope.grid.dataSource.read();$scope.loaderForm=false;break;}},function(response){alert("Error: "+response.data);$scope.loaderForm=false;});}}}
displayMessagesArray=function(data){var messages="";angular.forEach(data,function(value,key){messages+=value+"\n";});alert(messages);}
displayErrors=function(errors){var messages="";angular.forEach(errors,function(value,key){if(value.length>1){angular.forEach(value,function(value,key){messages+=value+"\n";});}else{messages+=value+"\n";}});alert(messages);$scope.loaderForm=false;}
optionsGrid=function(){return $scope.optionsGrid={dataSource:{type:"json",transport:{read:'/admin/modulos/grid?tipo=html'},serpageSize:10,serverPaging:true,serverFiltering:true,serverSorting:true,schema:{data:"data",total:"total",model:{id:"id",fields:{id:{type:"number"}}}}},sortable:true,reorderable:true,resizable:true,mobile:true,selectable:true,groupable:{messages:{empty:"Arraste uma coluna para agrupar"}},pageable:{refresh:true,pageSize:10,pageSizes:true,messages:{display:"{0} - {1} de {2} itens",empty:"Não Existem Itens para mostrar",page:"Página",of:"de {0}",itemsPerPage:"itens por Página",first:"Primeira Página",previous:"Página Anterior",next:"Próxima Página",last:"Última Página",refresh:"Atualizar",}},filterable:{extra:true,messages:{clear:"Limpar",filter:"buscar",info:"Registros que:",and:"e",or:"ou",selectValue:"Selecione",},operators:{string:{startswith:"Começa com",endswith:"Termina com",eq:"Seja igual a",neq:"Não é igual a",contains:"Contém",doesnotcontain:"Não contém",},date:{eq:"Igual a",gte:"Maior ou igual a",gt:"Maior que",lte:"Menor ou igual a",lt:"Menor que"},number:{eq:"Igual a",gte:"Maior ou igual a",gt:"Maior que",lte:"Menor ou igual a",lt:"Menor que"},enums:{eq:"Seja igual a",neq:"Não é igual a"}}},toolbar:[{template:"<button class='k-button' ng-disabled='access_create == false' ng-click='window.new()'><span class='k-icon k-i-plus' style='padding:0 2px 0 0;'></span></button>"},{template:"<button class='k-button' ng-click='delete(\"multiple\")'><span class='k-icon k-i-close' style='padding:0 2px 0 0;'></span></button>"}],columns:[{title:"<input type='checkbox' ng-model='checkAll' />",width:"30px",template:"<input type='checkbox' class='itemGrid' ng-model='itensGrid' ng-value='dataItem.id' ng-checked='checkAll'/>",filterable:false,sortable:false},{field:"id",title:"Id",type:"number",width:"50px"},{field:"titulo",title:"Titulo",type:"string"},{field:"apelido",title:"Apelido",type:"string"},{field:"ordem",title:"Ordem",type:"number",width:"100px"},{field:"modulo_posicao_id",title:"Posição",type:"number",values:ListDataService.moduloPosicaoGrid()},{command:[{template:"<button class=\'k-button\'  ng-click=\'window.edit(dataItem)\'><span class='k-icon k-i-pencil' style='padding:0 2px 0 0;'></span></button>"},{template:"<button  class=\'k-button\'  ng-click=\'delete(dataItem)\'><span class='k-icon k-i-close' style='padding:0 2px 0 0;'></span></button>"},{template:"<button class='k-button' ng-click='window.ordem(dataItem)'>Ordem</button>"}]}]}}
optionsModal=function(){$scope.conf_modal={title:'Módulo Html',width:'1000',height:'500',actions:["Minimize","Maximize","Close"],visible:false,modal:true,resizable:true,animation:{close:{duration:200},open:{duration:200}}}
$scope.conf_modal_ordem={title:'Ordenação',width:'500',height:'500',actions:["Minimize","Maximize"],visible:false,modal:true,resizable:true,animation:{close:{duration:200},open:{duration:200}},open:function(){$scope.openOrdem=true;},close:function(){$scope.openOrdem=false;}}}
optionsCombo=function(){$scope.comboPosicao={filter:'contains',dataTextField:"descricao",dataValueField:"id",dataSource:{transport:{read:{url:"/admin/modulo-posicaos/combo",async:false}}},change:function(e){var data=this.dataSource.data();var input=this.value();var search=false;angular.forEach(data,function(v,key){if(v.id==input){search=true;}});if(search==false){this.value("");}}}
$scope.comboMostrarTitulo={filter:'contains',dataTextField:"text",dataValueField:"value",autoBind:false,dataSource:{data:[{text:"Não",value:false},{text:"Sim",value:true}]}}
$scope.comboTagTitulo={filter:'contains',dataTextField:"v",dataValueField:"v",autoBind:false,dataSource:{data:[{v:"h1"},{v:"h2"},{v:"h3"},{v:"h4"},{v:"h5"},{v:"h6"}]}}}
$scope.updateOrdemModulo=function(){var request=$resource('/admin/modulos/updateModulosOrdem',{_token:CSRF_TOKEN},{update:{method:"PUT"}});if($rootScope.itensOrdemModuloSortable==""){$(".status-ordem-modulo").removeClass('primary bt-danger').addClass('btn-success').html("<span>Ordem atualizada</span>");}else{$(".status-ordem-modulo").removeClass('btn-success bt-danger').addClass('btn-primary').html("<span>Alterando Ordem</span>");request.update({itens:$rootScope.itensOrdemModuloSortable},function(response){$(".status-ordem-modulo").removeClass('primary bt-danger').addClass('btn-success').html("<span>Ordem atualizada</span>");$scope.grid.dataSource.read();},function(response){alert('error');})}}
$scope.refreshComboPosicao=function(){var comboPosicao=$("#comboPosicao").data("kendoComboBox");comboPosicao.dataSource.read();}
init=function(){AuthService.checkView("modulos");AuthService.checkView("modulo-html");$scope.openOrdem=false;$rootScope.itensOrdemModuloSortable="";optionsCombo();optionsModal();optionsGrid();}
init();});$app.controller('ModuloContatoController',function($scope,$rootScope,$resource,AuthService,ListDataService,CSRF_TOKEN){$scope.title="Módulo Contato";$scope.window={new:function(){$scope.dataItem={titulo:"",apelido:"",tipo:"contato",modulo_posicao_id:"",publicado:true,mostrar_titulo:0,tag_titulo:"h1",conteudo:"",parametros:{contato_id:"",class:"",id:""},ordem:""};$scope.mostrar_titulo="";$scope.formView="new";$scope.formAction="create()";$scope.modal.setOptions({title:"Adicionar Módulo"});$scope.modal.open().center();},edit:function(dataItem){$scope.formView="edit";$scope.formAction="update()";$scope.modal.setOptions({title:"Editar Módulo: "+dataItem.id});$scope.modal.open().center();$scope.dataItem=dataItem;$scope.dataItem.parametros=angular.fromJson(dataItem.parametros);if(dataItem.mostrar_titulo==true){$scope.dataItem.mostrar_titulo=1;}
if(dataItem.mostrar_titulo==false){$scope.dataItem.mostrar_titulo=0;}},ordem:function(dataItem){$scope.dataItem=dataItem;$scope.modal_ordem.open().center();},close:function(){$scope.modal.close();},close_ordem:function(){$scope.modal_ordem.close();}}
$scope.executeAction=function(action){switch(action){case"create()":create();break;case"update()":update();break;}}
create=function(){if(AuthService.checkCreate("modulo-html")&&AuthService.checkCreate("modulos")){var request=$resource("/admin/modulos",{_token:CSRF_TOKEN});$scope.loaderForm=true;''
request.save($scope.dataItem,function(response){switch(response.status){case 0:return displayErrors(response.data);break;case 1:alert(response.data);$scope.dataItem={titulo:"",apelido:"",tipo:"contato",modulo_posicao_id:"",publicado:true,mostrar_titulo:0,tag_titulo:"h1",conteudo:"",parametros:{contato_id:"",class:"",id:""},ordem:""};$scope.grid.dataSource.read();$scope.loaderForm=false;break;case 2:alert(response.data);$scope.loaderForm=false;break;}},function(response){$scope.loaderForm=false;});}}
update=function(){if(AuthService.checkUpdate("modulo-html")&&AuthService.checkUpdate("modulos")){var request=$resource("/admin/modulos",{_token:CSRF_TOKEN},{update:{method:"PUT"}});$scope.loaderForm=true;request.update($scope.dataItem,function(response){switch(response.status){case 0:return displayErrors(response.data);break;case 1:alert(response.data);$scope.grid.dataSource.read();$scope.loaderForm=false;break;case 2:alert(response.data);$scope.loaderForm=false;break;}},function(response){$scope.loaderForm=false;});}}
$scope.delete=function(dataItem){if(AuthService.checkDelete("modulo-html")&&AuthService.checkDelete("modulos")){if(confirm("Deseja deletar esse(s) registro(s)?")){var ids=[];var type="single";var id=dataItem.id;if(dataItem=="multiple"){if($(".itemGrid:checked").length==0){alert("Nenhum item marcado.");return false;}
$(".itemGrid:checked").map(function(key,value){ids.push(value.value);});type="multiple";id=ids[0];}
var request=$resource("/admin/modulos");$scope.loaderForm=true;request.delete({id:id,ids:[ids],type:type,_token:CSRF_TOKEN},function(response){switch(response.status){case 2:alert(response.data);$scope.loaderForm=false;break;default:if(type=="multiple"){displayMessagesArray(response.data);}else{alert(response.data);}
$scope.grid.dataSource.read();$scope.loaderForm=false;break;}},function(response){alert("Error: "+response.data);$scope.loaderForm=false;});}}}
displayMessagesArray=function(data){var messages="";angular.forEach(data,function(value,key){messages+=value+"\n";});alert(messages);}
displayErrors=function(errors){var messages="";angular.forEach(errors,function(value,key){if(value.length>1){angular.forEach(value,function(value,key){messages+=value+"\n";});}else{messages+=value+"\n";}});alert(messages);$scope.loaderForm=false;}
optionsGrid=function(){return $scope.optionsGrid={dataSource:{type:"json",transport:{read:'/admin/modulos/grid?tipo=contato'},serpageSize:10,serverPaging:true,serverFiltering:true,serverSorting:true,schema:{data:"data",total:"total",model:{id:"id",fields:{id:{type:"number"}}}}},sortable:true,reorderable:true,resizable:true,mobile:true,selectable:true,groupable:{messages:{empty:"Arraste uma coluna para agrupar"}},pageable:{refresh:true,pageSize:10,pageSizes:true,messages:{display:"{0} - {1} de {2} itens",empty:"Não Existem Itens para mostrar",page:"Página",of:"de {0}",itemsPerPage:"itens por Página",first:"Primeira Página",previous:"Página Anterior",next:"Próxima Página",last:"Última Página",refresh:"Atualizar",}},filterable:{extra:true,messages:{clear:"Limpar",filter:"buscar",info:"Registros que:",and:"e",or:"ou",selectValue:"Selecione",},operators:{string:{startswith:"Começa com",endswith:"Termina com",eq:"Seja igual a",neq:"Não é igual a",contains:"Contém",doesnotcontain:"Não contém",},date:{eq:"Igual a",gte:"Maior ou igual a",gt:"Maior que",lte:"Menor ou igual a",lt:"Menor que"},number:{eq:"Igual a",gte:"Maior ou igual a",gt:"Maior que",lte:"Menor ou igual a",lt:"Menor que"},enums:{eq:"Seja igual a",neq:"Não é igual a"}}},toolbar:[{template:"<button class='k-button' ng-disabled='access_create == false' ng-click='window.new()'><span class='k-icon k-i-plus' style='padding:0 2px 0 0;'></span></button>"},{template:"<button class='k-button' ng-click='delete(\"multiple\")'><span class='k-icon k-i-close' style='padding:0 2px 0 0;'></span></button>"}],columns:[{title:"<input type='checkbox' ng-model='checkAll' />",width:"30px",template:"<input type='checkbox' class='itemGrid' ng-model='itensGrid' ng-value='dataItem.id' ng-checked='checkAll'/>",filterable:false,sortable:false},{field:"id",title:"Id",type:"number",width:"50px"},{field:"titulo",title:"Titulo",type:"string"},{field:"apelido",title:"Apelido",type:"string"},{field:"ordem",title:"Ordem",type:"number",width:"100px"},{field:"modulo_posicao_id",title:"Posição",type:"number",values:ListDataService.moduloPosicaoGrid()},{command:[{template:"<button class=\'k-button\'  ng-click=\'window.edit(dataItem)\'><span class='k-icon k-i-pencil' style='padding:0 2px 0 0;'></span></button>"},{template:"<button  class=\'k-button\'  ng-click=\'delete(dataItem)\'><span class='k-icon k-i-close' style='padding:0 2px 0 0;'></span></button>"},{template:"<button class='k-button' ng-click='window.ordem(dataItem)'>Ordem</button>"}]}]}}
optionsModal=function(){$scope.conf_modal={title:'Módulo Html',width:'1000',height:'500',actions:["Minimize","Maximize","Close"],visible:false,modal:true,resizable:true,animation:{close:{duration:200},open:{duration:200}}}
$scope.conf_modal_ordem={title:'Ordenação',width:'500',height:'500',actions:["Minimize","Maximize"],visible:false,modal:true,resizable:true,animation:{close:{duration:200},open:{duration:200}},open:function(){$scope.openOrdem=true;},close:function(){$scope.openOrdem=false;}}}
optionsCombo=function(){$scope.comboPosicao={filter:'contains',dataTextField:"descricao",dataValueField:"id",dataSource:{transport:{read:{url:"/admin/modulo-posicaos/combo",async:false}}},change:function(e){var data=this.dataSource.data();var input=this.value();var search=false;angular.forEach(data,function(v,key){if(v.id==input){search=true;}});if(search==false){this.value("");}}}
$scope.comboContato={filter:'contains',dataTextField:"titulo",dataValueField:"id",autoBind:0,dataSource:{transport:{read:{url:"/admin/componentes/contatos/combo",async:true}}},change:function(e){var data=this.dataSource.data();var input=this.value();var search=false;angular.forEach(data,function(v,key){if(v.id==input){search=true;}});if(search==false){this.value("");}}}
$scope.comboMostrarTitulo={filter:'contains',dataTextField:"text",dataValueField:"value",autoBind:false,dataSource:{data:[{text:"Não",value:false},{text:"Sim",value:true}]}}
$scope.comboTagTitulo={filter:'contains',dataTextField:"v",dataValueField:"v",autoBind:false,dataSource:{data:[{v:"h1"},{v:"h2"},{v:"h3"},{v:"h4"},{v:"h5"},{v:"h6"}]}}}
$scope.updateOrdemModulo=function(){var request=$resource('/admin/modulos/updateModulosOrdem',{_token:CSRF_TOKEN},{update:{method:"PUT"}});if($rootScope.itensOrdemModuloSortable==""){$(".status-ordem-modulo").removeClass('primary bt-danger').addClass('btn-success').html("<span>Ordem atualizada</span>");}else{$(".status-ordem-modulo").removeClass('btn-success bt-danger').addClass('btn-primary').html("<span>Alterando Ordem</span>");request.update({itens:$rootScope.itensOrdemModuloSortable},function(response){$(".status-ordem-modulo").removeClass('primary bt-danger').addClass('btn-success').html("<span>Ordem atualizada</span>");$scope.grid.dataSource.read();},function(response){alert('error');})}}
$scope.refreshComboPosicao=function(){var comboPosicao=$("#comboPosicao").data("kendoComboBox");comboPosicao.dataSource.read();}
init=function(){AuthService.checkView("modulos");AuthService.checkView("modulo-html");$scope.openOrdem=false;$rootScope.itensOrdemModuloSortable="";optionsCombo();optionsModal();optionsGrid();}
init();});$app.controller('ModuloBannerSliderController',function($scope,$rootScope,$resource,AuthService,ListDataService,CSRF_TOKEN){$scope.title="Módulo Banner Slider";$scope.window={new:function(){var comboBanner=$('#comboBanner').data('kendoComboBox');$scope.dataItem={titulo:"",apelido:"",tipo:"banner-slider",modulo_posicao_id:"",publicado:true,mostrar_titulo:0,tag_titulo:"h1",conteudo:"",parametros:{banner_id:"",efeito:"fade",timeout:4000,speed:1000,pause:0,prev:0,next:0,paginacao:0,class:"",id:""},ordem:""};$scope.mostrar_titulo="";$scope.formView="new";$scope.formAction="create()";$scope.modal.setOptions({title:"Adicionar Módulo"});$scope.modal.open().center();},edit:function(dataItem){$scope.formView="edit";$scope.formAction="update()";$scope.modal.setOptions({title:"Editar Módulo: "+dataItem.id});$scope.modal.open().center();$scope.dataItem=dataItem;$scope.dataItem.parametros=angular.fromJson(dataItem.parametros);if(dataItem.mostrar_titulo==true){$scope.dataItem.mostrar_titulo=1;}
if(dataItem.mostrar_titulo==false){$scope.dataItem.mostrar_titulo=0;}},ordem:function(dataItem){$scope.dataItem=dataItem;$scope.modal_ordem.open().center();},close:function(){$scope.modal.close();},close_ordem:function(){$scope.modal_ordem.close();}}
$scope.executeAction=function(action){switch(action){case"create()":create();break;case"update()":update();break;}}
create=function(){if(AuthService.checkCreate("modulo-banner-slider")&&AuthService.checkCreate("modulos")){var request=$resource("/admin/modulos",{_token:CSRF_TOKEN});$scope.loaderForm=true;''
request.save($scope.dataItem,function(response){switch(response.status){case 0:return displayErrors(response.data);break;case 1:alert(response.data);$scope.dataItem={titulo:"",apelido:"",tipo:"banner-slider",modulo_posicao_id:"",publicado:true,mostrar_titulo:0,tag_titulo:"h1",conteudo:"",parametros:{banner_id:"",efeito:"fade",timeout:4000,speed:1000,pause:0,prev:0,next:0,paginacao:0,class:"",id:""},ordem:""};$scope.grid.dataSource.read();$scope.loaderForm=false;break;case 2:alert(response.data);$scope.loaderForm=false;break;}},function(response){$scope.loaderForm=false;});}}
update=function(){if(AuthService.checkUpdate("modulo-banner-slider")&&AuthService.checkUpdate("modulos")){var request=$resource("/admin/modulos",{_token:CSRF_TOKEN},{update:{method:"PUT"}});$scope.loaderForm=true;request.update($scope.dataItem,function(response){switch(response.status){case 0:return displayErrors(response.data);break;case 1:alert(response.data);$scope.grid.dataSource.read();$scope.loaderForm=false;break;case 2:alert(response.data);$scope.loaderForm=false;break;}},function(response){$scope.loaderForm=false;});}}
$scope.delete=function(dataItem){if(AuthService.checkDelete("modulo-banner-slider")&&AuthService.checkDelete("modulos")){if(confirm("Deseja deletar esse(s) registro(s)?")){var ids=[];var type="single";var id=dataItem.id;if(dataItem=="multiple"){if($(".itemGrid:checked").length==0){alert("Nenhum item marcado.");return false;}
$(".itemGrid:checked").map(function(key,value){ids.push(value.value);});type="multiple";id=ids[0];}
var request=$resource("/admin/modulos");$scope.loaderForm=true;request.delete({id:id,ids:[ids],type:type,_token:CSRF_TOKEN},function(response){switch(response.status){case 2:alert(response.data);$scope.loaderForm=false;break;default:if(type=="multiple"){displayMessagesArray(response.data);}else{alert(response.data);}
$scope.grid.dataSource.read();$scope.loaderForm=false;break;}},function(response){alert("Error: "+response.data);$scope.loaderForm=false;});}}}
displayMessagesArray=function(data){var messages="";angular.forEach(data,function(value,key){messages+=value+"\n";});alert(messages);}
displayErrors=function(errors){var messages="";angular.forEach(errors,function(value,key){if(value.length>1){angular.forEach(value,function(value,key){messages+=value+"\n";});}else{messages+=value+"\n";}});alert(messages);$scope.loaderForm=false;}
optionsGrid=function(){return $scope.optionsGrid={dataSource:{type:"json",transport:{read:'/admin/modulos/grid?tipo=banner-slider'},serpageSize:10,serverPaging:true,serverFiltering:true,serverSorting:true,schema:{data:"data",total:"total",model:{id:"id",fields:{id:{type:"number"}}}}},sortable:true,reorderable:true,resizable:true,mobile:true,selectable:true,groupable:{messages:{empty:"Arraste uma coluna para agrupar"}},pageable:{refresh:true,pageSize:10,pageSizes:true,messages:{display:"{0} - {1} de {2} itens",empty:"Não Existem Itens para mostrar",page:"Página",of:"de {0}",itemsPerPage:"itens por Página",first:"Primeira Página",previous:"Página Anterior",next:"Próxima Página",last:"Última Página",refresh:"Atualizar",}},filterable:{extra:true,messages:{clear:"Limpar",filter:"buscar",info:"Registros que:",and:"e",or:"ou",selectValue:"Selecione",},operators:{string:{startswith:"Começa com",endswith:"Termina com",eq:"Seja igual a",neq:"Não é igual a",contains:"Contém",doesnotcontain:"Não contém",},date:{eq:"Igual a",gte:"Maior ou igual a",gt:"Maior que",lte:"Menor ou igual a",lt:"Menor que"},number:{eq:"Igual a",gte:"Maior ou igual a",gt:"Maior que",lte:"Menor ou igual a",lt:"Menor que"},enums:{eq:"Seja igual a",neq:"Não é igual a"}}},toolbar:[{template:"<button class='k-button' ng-disabled='access_create == false' ng-click='window.new()'><span class='k-icon k-i-plus' style='padding:0 2px 0 0;'></span></button>"},{template:"<button class='k-button' ng-click='delete(\"multiple\")'><span class='k-icon k-i-close' style='padding:0 2px 0 0;'></span></button>"}],columns:[{title:"<input type='checkbox' ng-model='checkAll' />",width:"30px",template:"<input type='checkbox' class='itemGrid' ng-model='itensGrid' ng-value='dataItem.id' ng-checked='checkAll'/>",filterable:false,sortable:false},{field:"id",title:"Id",type:"number",width:"50px"},{field:"titulo",title:"Titulo",type:"string"},{field:"apelido",title:"Apelido",type:"string"},{field:"ordem",title:"Ordem",type:"number",width:"100px"},{field:"modulo_posicao_id",title:"Posição",type:"number",values:ListDataService.moduloPosicaoGrid()},{command:[{template:"<button class=\'k-button\'  ng-click=\'window.edit(dataItem)\'><span class='k-icon k-i-pencil' style='padding:0 2px 0 0;'></span></button>"},{template:"<button  class=\'k-button\'  ng-click=\'delete(dataItem)\'><span class='k-icon k-i-close' style='padding:0 2px 0 0;'></span></button>"},{template:"<button class='k-button' ng-click='window.ordem(dataItem)'>Ordem</button>"}]}]}}
optionsModal=function(){$scope.conf_modal={title:'Módulo Html',width:'1000',height:'500',actions:["Minimize","Maximize","Close"],visible:false,modal:true,resizable:true,animation:{close:{duration:200},open:{duration:200}}}
$scope.conf_modal_ordem={title:'Ordenação',width:'500',height:'500',actions:["Minimize","Maximize"],visible:false,modal:true,resizable:true,animation:{close:{duration:200},open:{duration:200}},open:function(){$scope.openOrdem=true;},close:function(){$scope.openOrdem=false;}}}
optionsCombo=function(){$scope.comboPosicao={filter:'contains',dataTextField:"descricao",dataValueField:"id",dataSource:{transport:{read:{url:"/admin/modulo-posicaos/combo",async:false}}},change:function(e){var data=this.dataSource.data();var input=this.value();var search=false;angular.forEach(data,function(v,key){if(v.id==input){search=true;}});if(search==false){this.value("");}}}
$scope.comboMostrarTitulo={filter:'contains',dataTextField:"text",dataValueField:"value",autoBind:false,dataSource:{data:[{text:"Não",value:false},{text:"Sim",value:true}]}}
$scope.comboTagTitulo={filter:'contains',dataTextField:"v",dataValueField:"v",autoBind:false,dataSource:{data:[{v:"h1"},{v:"h2"},{v:"h3"},{v:"h4"},{v:"h5"},{v:"h6"}]}}
$scope.comboBanner={filter:'contains',dataTextField:"descricao",dataValueField:"id",dataSource:{transport:{read:{url:"/admin/componentes/banner-sliders/combo",async:false}}},change:function(e){var data=this.dataSource.data();var input=this.value();var search=false;angular.forEach(data,function(v,key){if(v.id==input){search=true;}});if(search==false){this.value("");}}}
$scope.optionsEfeito={filter:'contains',dataTextField:"v",dataValueField:"v",autoBind:false,dataSource:{data:[{v:"blindX"},{v:"blindY"},{v:"blindZ"},{v:"cover"},{v:"curtainX"},{v:"curtainY"},{v:"fade"},{v:"fadeZoom"},{v:"growX"},{v:"growY"},{v:"none"},{v:"scrollUp"},{v:"scrollDown"},{v:"scrollLeft"},{v:"scrollRight"},{v:"scrollHorz"},{v:"scrollVert"},{v:"shuffle"},{v:"slideX"},{v:"slideY"},{v:"toss"},{v:"turnUp"},{v:"turnDown"},{v:"turnLeft"},{v:"turnRight"},{v:"uncover"},{v:"wipe"},{v:"zoom"}]}}
$scope.optionsTimeout={filter:'contains',dataTextField:"t",dataValueField:"v",autoBind:false,dataSource:{data:[{v:1000,t:"1 Segundo"},{v:2000,t:"2 Segundos"},{v:3000,t:"3 Segundos"},{v:4000,t:"4 Segundos"},{v:5000,t:"5 Segundos"},{v:6000,t:"6 Segundos"},{v:7000,t:"7 Segundos"},{v:8000,t:"8 Segundos"},{v:9000,t:"9 Segundos"},{v:10000,t:"10 Segundos"}]}}
$scope.optionsSpeed={filter:'contains',dataTextField:"t",dataValueField:"v",autoBind:false,dataSource:{data:[{v:1000,t:"1 Segundo"},{v:2000,t:"2 Segundos"},{v:3000,t:"3 Segundos"},{v:4000,t:"4 Segundos"},{v:5000,t:"5 Segundos"},{v:6000,t:"6 Segundos"},{v:7000,t:"7 Segundos"},{v:8000,t:"8 Segundos"},{v:9000,t:"9 Segundos"},{v:10000,t:"10 Segundos"}]}}
$scope.optionsPause={filter:'contains',dataTextField:"t",dataValueField:"v",autoBind:false,dataSource:{data:[{v:1,t:"Sim"},{v:0,t:"Não"}]}}
$scope.optionsPrev={filter:'contains',dataTextField:"t",dataValueField:"v",autoBind:false,dataSource:{data:[{v:1,t:"Sim"},{v:0,t:"Não"}]}}
$scope.optionsNext={filter:'contains',dataTextField:"t",dataValueField:"v",autoBind:false,dataSource:{data:[{v:1,t:"Sim"},{v:0,t:"Não"}]}}
$scope.optionsPaginacao={filter:'contains',dataTextField:"t",dataValueField:"v",autoBind:false,dataSource:{data:[{v:1,t:"Sim"},{v:0,t:"Não"}]}}}
$scope.updateOrdemModulo=function(){var request=$resource('/admin/modulos/updateModulosOrdem',{_token:CSRF_TOKEN},{update:{method:"PUT"}});if($rootScope.itensOrdemModuloSortable==""){$(".status-ordem-modulo").removeClass('primary bt-danger').addClass('btn-success').html("<span>Ordem atualizada</span>");}else{$(".status-ordem-modulo").removeClass('btn-success bt-danger').addClass('btn-primary').html("<span>Alterando Ordem</span>");request.update({itens:$rootScope.itensOrdemModuloSortable},function(response){$(".status-ordem-modulo").removeClass('primary bt-danger').addClass('btn-success').html("<span>Ordem atualizada</span>");$scope.grid.dataSource.read();},function(response){alert('error');})}}
$scope.refreshComboPosicao=function(){var comboPosicao=$("#comboPosicao").data("kendoComboBox");comboPosicao.dataSource.read();}
init=function(){AuthService.checkView("modulos");AuthService.checkView("modulo-banner-slider");$scope.openOrdem=false;$rootScope.itensOrdemModuloSortable="";optionsCombo();optionsModal();optionsGrid();}
init();});$app.controller('MidiasController',function($scope,$http,$window,$location,$resource,AuthService){$scope.title="Mídias";init=function(){AuthService.checkView("midias");}
init();});$app.controller('ArtigosController',function($scope,$http,$window,$location,$resource,AuthService,ListDataService,CSRF_TOKEN){$scope.title="Artigos";$scope.window={new:function(){$scope.dataItem={titulo:"",apelido:"",artigo_categoria_id:"",publicado:true,destaque:false,mostrar_titulo:false,tag_titulo:"h1",mini_descricao:"",descricao:"",meta_title:"",meta_description:"",meta_keywords:"",meta_author:"",parametros:[]};$scope.formView="new";$scope.formAction="create()";$scope.modal.setOptions({title:"Adicionar Artigo"});$scope.modal.open().center();},edit:function(dataItem){$scope.formView="edit";$scope.formAction="update()";$scope.modal.setOptions({title:"Editar Artigo: "+dataItem.id});$scope.modal.open().center();$scope.dataItem=dataItem;},close:function(){$scope.modal.close();}}
$scope.executeAction=function(action){switch(action){case"create()":create();break;case"update()":update();break;}}
create=function(){if(AuthService.checkCreate("artigos")&&AuthService.checkCreate("conteudo")){var user=$resource("/admin/conteudo/artigos",{_token:CSRF_TOKEN});$scope.loaderForm=true;user.save($scope.dataItem,function(response){switch(response.status){case 0:return displayErrors(response.data);break;case 1:alert(response.data);$scope.dataItem={titulo:"",apelido:"",artigo_categoria_id:"",publicado:true,destaque:false,mostrar_titulo:false,tag_titulo:"h1",mini_descricao:"",descricao:"",meta_title:"",meta_description:"",meta_keywords:"",meta_author:""};$scope.grid.dataSource.read();$scope.loaderForm=false;break;case 2:alert(response.data);$scope.loaderForm=false;break;}},function(response){$scope.loaderForm=false;});}}
update=function(){if(AuthService.checkUpdate("artigos")&&AuthService.checkUpdate("conteudo")){var user=$resource("/admin/conteudo/artigos",{_token:CSRF_TOKEN},{update:{method:"PUT"}});$scope.loaderForm=true;user.update($scope.dataItem,function(response){switch(response.status){case 0:return displayErrors(response.data);break;case 1:alert(response.data);$scope.grid.dataSource.read();$scope.loaderForm=false;break;case 2:alert(response.data);$scope.loaderForm=false;break;}},function(response){$scope.loaderForm=false;});}}
$scope.delete=function(dataItem){if(AuthService.checkDelete("artigos")&&AuthService.checkDelete("conteudo")){if(confirm("Deseja deletar esse(s) registro(s)?")){var ids=[];var type="single";var id=dataItem.id;if(dataItem=="multiple"){if($(".itemGrid:checked").length==0){alert("Nenhum item marcado.");return false;}
$(".itemGrid:checked").map(function(key,value){ids.push(value.value);});type="multiple";id=ids[0];}
var user=$resource("/admin/conteudo/artigos");$scope.loaderForm=true;user.delete({id:id,ids:[ids],type:type,_token:CSRF_TOKEN},function(response){switch(response.status){case 2:alert(response.data);$scope.loaderForm=false;break;default:if(type=="multiple"){displayMessagesArray(response.data);}else{alert(response.data);}
$scope.grid.dataSource.read();$scope.loaderForm=false;break;}},function(response){alert("Error: "+response.data);$scope.loaderForm=false;});}}}
displayMessagesArray=function(data){var messages="";angular.forEach(data,function(value,key){messages+=value+"\n";});alert(messages);}
displayErrors=function(errors){var messages="";angular.forEach(errors,function(value,key){if(value.length>1){angular.forEach(value,function(value,key){messages+=value+"\n";});}else{messages+=value+"\n";}});alert(messages);$scope.loaderForm=false;}
optionsGrid=function(){return $scope.optionsGrid={dataSource:{type:"json",transport:{read:'/admin/conteudo/artigos/grid'},serpageSize:10,serverPaging:true,serverFiltering:true,serverSorting:true,schema:{data:"data",total:"total",model:{id:"id",fields:{id:{type:"number"}}}}},sortable:true,reorderable:true,resizable:true,mobile:true,selectable:true,groupable:{messages:{empty:"Arraste uma coluna para agrupar"}},pageable:{refresh:true,pageSize:10,pageSizes:true,messages:{display:"{0} - {1} de {2} itens",empty:"Não Existem Itens para mostrar",page:"Página",of:"de {0}",itemsPerPage:"itens por Página",first:"Primeira Página",previous:"Página Anterior",next:"Próxima Página",last:"Última Página",refresh:"Atualizar",}},filterable:{extra:true,messages:{clear:"Limpar",filter:"buscar",info:"Registros que:",and:"e",or:"ou",selectValue:"Selecione",},operators:{string:{startswith:"Começa com",endswith:"Termina com",eq:"Seja igual a",neq:"Não é igual a",contains:"Contém",doesnotcontain:"Não contém",},date:{eq:"Igual a",gte:"Maior ou igual a",gt:"Maior que",lte:"Menor ou igual a",lt:"Menor que"},number:{eq:"Igual a",gte:"Maior ou igual a",gt:"Maior que",lte:"Menor ou igual a",lt:"Menor que"},enums:{eq:"Seja igual a",neq:"Não é igual a"}}},toolbar:[{template:"<button class='k-button' ng-disabled='access_create == false' ng-click='window.new()'><span class='k-icon k-i-plus' style='padding:0 2px 0 0;'></span></button>"},{template:"<button class='k-button' ng-click='delete(\"multiple\")'><span class='k-icon k-i-close' style='padding:0 2px 0 0;'></span></button>"}],columns:[{title:"<input type='checkbox' ng-model='checkAll' />",width:"30px",template:"<input type='checkbox' class='itemGrid' ng-model='itensGrid' ng-value='dataItem.id' ng-checked='checkAll'/>",filterable:false,sortable:false},{field:"id",title:"Id",type:"number",width:"50px"},{field:"titulo",title:"Titulo",type:"string"},{field:"apelido",title:"Apelido",type:"string"},{field:"artigo_categoria_id",title:"Categoria",type:"number",values:ListDataService.artigoCategoriasGrid()},{command:[{template:"<button class=\'k-button\' ng-disabled='access_update == false' ng-click=\'window.edit(dataItem)\'><span class='k-icon k-i-pencil' style='padding:0 2px 0 0;'></span></button>"},{template:"<button  class=\'k-button\' ng-disabled='access_destroy == false' ng-click=\'delete(dataItem)\'><span class='k-icon k-i-close' style='padding:0 2px 0 0;'></span></button>"}]}]}}
optionsModal=function(){$scope.conf_modal={title:'Artigos',width:'1000',height:'500',actions:["Minimize","Maximize","Close"],visible:false,modal:true,resizable:true,animation:{close:{duration:200},open:{duration:200}}}}
optionsCombo=function(){$scope.comboCategoria={filter:'contains',dataTextField:"descricao",dataValueField:"id",dataSource:{transport:{read:{url:"/admin/conteudo/artigo-categorias/combo",async:false}}},change:function(e){var data=this.dataSource.data();var input=this.value();var search=false;angular.forEach(data,function(v,key){if(v.id==input){search=true;}});if(search==false){this.value("");}}}
$scope.comboMostrarTitulo={filter:'contains',dataTextField:"text",dataValueField:"value",autoBind:false,dataSource:{data:[{text:"Não",value:false},{text:"Sim",value:true}]}}
$scope.comboTagTitulo={filter:'contains',dataTextField:"v",dataValueField:"v",autoBind:false,dataSource:{data:[{v:"h1"},{v:"h2"},{v:"h3"},{v:"h4"},{v:"h5"},{v:"h6"}]}}}
init=function(){AuthService.checkView("conteudo");AuthService.checkView("artigos");optionsGrid();optionsCombo();optionsModal();}
init();});$app.controller('ArtigoCategoriasController',function($scope,$http,$window,$location,$resource,AuthService,CSRF_TOKEN){$scope.title="Categorias";$scope.window={new:function(){$scope.dataItem={descricao:"",meta_title:"",meta_description:"",meta_keywords:"",meta_author:""};$scope.formView="new";$scope.formAction="create()";$scope.modal.setOptions({title:"Adicionar Categoria"});$scope.modal.open().center();},edit:function(dataItem){$scope.formView="edit";$scope.formAction="update()";$scope.modal.setOptions({title:"Editar Categoria: "+dataItem.id});$scope.modal.open().center();$scope.dataItem=dataItem;},close:function(){$scope.modal.close();}}
$scope.executeAction=function(action){switch(action){case"create()":create();break;case"update()":update();break;}}
create=function(){if(AuthService.checkCreate("artigo-categorias")&&AuthService.checkCreate("conteudo")){var user=$resource("/admin/conteudo/artigo-categorias",{_token:CSRF_TOKEN});$scope.loaderForm=true;user.save($scope.dataItem,function(response){switch(response.status){case 0:return displayErrors(response.data);break;case 1:alert(response.data);$scope.dataItem={descricao:"",meta_title:"",meta_description:"",meta_keywords:"",meta_author:""};$scope.grid.dataSource.read();$scope.loaderForm=false;break;case 2:alert(response.data);$scope.loaderForm=false;break;}},function(response){$scope.loaderForm=false;});}}
update=function(){if(AuthService.checkUpdate("artigo-categorias")&&AuthService.checkUpdate("conteudo")){var user=$resource("/admin/conteudo/artigo-categorias",{_token:CSRF_TOKEN},{update:{method:"PUT"}});$scope.loaderForm=true;user.update($scope.dataItem,function(response){switch(response.status){case 0:return displayErrors(response.data);break;case 1:alert(response.data);$scope.grid.dataSource.read();$scope.loaderForm=false;break;case 2:alert(response.data);$scope.loaderForm=false;break;}},function(response){$scope.loaderForm=false;});}}
$scope.delete=function(dataItem){if(AuthService.checkDelete("artigo-categorias")&&AuthService.checkDelete("conteudo")){if(confirm("Deseja deletar esse(s) registro(s)?")){var ids=[];var type="single";var id=dataItem.id;if(dataItem=="multiple"){if($(".itemGrid:checked").length==0){alert("Nenhum item marcado.");return false;}
$(".itemGrid:checked").map(function(key,value){ids.push(value.value);});type="multiple";id=ids[0];}
var user=$resource("/admin/conteudo/artigo-categorias");$scope.loaderForm=true;user.delete({id:id,ids:[ids],type:type,_token:CSRF_TOKEN},function(response){switch(response.status){case 2:alert(response.data);$scope.loaderForm=false;break;default:if(type=="multiple"){displayMessagesArray(response.data);}else{alert(response.data);}
$scope.grid.dataSource.read();$scope.loaderForm=false;break;}},function(response){alert("Error: "+response.data);$scope.loaderForm=false;});}}}
displayMessagesArray=function(data){var messages="";angular.forEach(data,function(value,key){messages+=value+"\n";});alert(messages);}
displayErrors=function(errors){var messages="";angular.forEach(errors,function(value,key){if(value.length>1){angular.forEach(value,function(value,key){messages+=value+"\n";});}else{messages+=value+"\n";}});alert(messages);$scope.loaderForm=false;}
optionsGrid=function(){return $scope.optionsGrid={dataSource:{type:"json",transport:{read:'/admin/conteudo/artigo-categorias/grid'},serpageSize:10,serverPaging:true,serverFiltering:true,serverSorting:true,schema:{data:"data",total:"total",model:{id:"id",fields:{id:{type:"number"}}}}},sortable:true,reorderable:true,resizable:true,mobile:true,selectable:true,groupable:{messages:{empty:"Arraste uma coluna para agrupar"}},pageable:{refresh:true,pageSize:10,pageSizes:true,messages:{display:"{0} - {1} de {2} itens",empty:"Não Existem Itens para mostrar",page:"Página",of:"de {0}",itemsPerPage:"itens por Página",first:"Primeira Página",previous:"Página Anterior",next:"Próxima Página",last:"Última Página",refresh:"Atualizar",}},filterable:{extra:true,messages:{clear:"Limpar",filter:"buscar",info:"Registros que:",and:"e",or:"ou",selectValue:"Selecione",},operators:{string:{startswith:"Começa com",endswith:"Termina com",eq:"Seja igual a",neq:"Não é igual a",contains:"Contém",doesnotcontain:"Não contém",},date:{eq:"Igual a",gte:"Maior ou igual a",gt:"Maior que",lte:"Menor ou igual a",lt:"Menor que"},number:{eq:"Igual a",gte:"Maior ou igual a",gt:"Maior que",lte:"Menor ou igual a",lt:"Menor que"},enums:{eq:"Seja igual a",neq:"Não é igual a"}}},toolbar:[{template:"<button class='k-button' ng-disabled='access_create == false' ng-click='window.new()'><span class='k-icon k-i-plus' style='padding:0 2px 0 0;'></span></button>"},{template:"<button class='k-button' ng-click='delete(\"multiple\")'><span class='k-icon k-i-close' style='padding:0 2px 0 0;'></span></button>"}],columns:[{title:"<input type='checkbox' ng-model='checkAll' />",width:"30px",template:"<input type='checkbox' class='itemGrid' ng-model='itensGrid' ng-value='dataItem.id' ng-checked='checkAll'/>",filterable:false,sortable:false},{field:"id",title:"Id",type:"number",width:"50px"},{field:"descricao",title:"Descrição",type:"string"},{command:[{template:"<button class=\'k-button\' ng-disabled='access_update == false' ng-click=\'window.edit(dataItem)\'><span class='k-icon k-i-pencil' style='padding:0 2px 0 0;'></span></button>"},{template:"<button  class=\'k-button\' ng-disabled='access_destroy == false' ng-click=\'delete(dataItem)\'><span class='k-icon k-i-close' style='padding:0 2px 0 0;'></span></button>"}]}]}}
optionsModal=function(){$scope.conf_modal={title:'Categorias',width:'600',height:'450',actions:["Minimize","Maximize","Close"],visible:false,modal:true,resizable:true,animation:{close:{duration:200},open:{duration:200}}}}
init=function(){AuthService.checkView("conteudo");AuthService.checkView("artigo-categorias");optionsGrid();optionsModal();}
init();});$app.controller('ContatoController',function($scope,$rootScope,$resource,AuthService,ListDataService,CSRF_TOKEN){$scope.title="Componente Contato";$scope.openModal=false;$scope.window={new:function(){$scope.openModal=true;$scope.dataItem={titulo:"",config_global:true,nome_remetente:"",email_remetente:"",autenticacao_email:0,usuario_email:"",senha_email:"",servidor_email:"",porta_email:"",descricao_antes:"",descricao_depois:"",meta_title:"",meta_description:"",meta_keywords:"",meta_author:"",parametros:[]};$scope.formView="new";$scope.formAction="create()";$scope.modal.setOptions({title:"Contato"});$scope.modal.open().center();$scope.openModal=true;},edit:function(dataItem){$scope.formView="edit";$scope.formAction="update()";$scope.modal.setOptions({title:"Editar Contato: "+dataItem.id});$scope.modal.open().center();$scope.dataItem=dataItem;$scope.dataItem.parametros=angular.fromJson(dataItem.parametros);if(dataItem.mostrar_titulo==true){$scope.dataItem.mostrar_titulo=1;}
if(dataItem.mostrar_titulo==false){$scope.dataItem.mostrar_titulo=0;}
$scope.openModal=true;},close:function(){$scope.modal.close();}}
$scope.executeAction=function(action){switch(action){case"create()":create();break;case"update()":update();break;}}
create=function(){if(AuthService.checkCreate("componente-contato")&&AuthService.checkCreate("componentes")){var request=$resource("/admin/componentes/contatos",{_token:CSRF_TOKEN});$scope.loaderForm=true;''
request.save($scope.dataItem,function(response){switch(response.status){case 0:return displayErrors(response.data);break;case 1:alert(response.data);$scope.dataItem={titulo:"",config_global:true,nome_remetente:"",email_remetente:"",autenticacao_email:0,usuario_email:"",senha_email:"",servidor_email:"",porta_email:"",descricao_antes:"",descricao_depois:"",meta_title:"",meta_description:"",meta_keywords:"",meta_author:"",parametros:[]};$scope.grid.dataSource.read();$scope.loaderForm=false;break;case 2:alert(response.data);$scope.loaderForm=false;break;}},function(response){$scope.loaderForm=false;});}}
update=function(){if(AuthService.checkUpdate("componente-contato")&&AuthService.checkUpdate("componentes")){var request=$resource("/admin/componentes/contatos",{_token:CSRF_TOKEN},{update:{method:"PUT"}});$scope.loaderForm=true;request.update($scope.dataItem,function(response){switch(response.status){case 0:return displayErrors(response.data);break;case 1:alert(response.data);$scope.grid.dataSource.read();$scope.loaderForm=false;break;case 2:alert(response.data);$scope.loaderForm=false;break;}},function(response){$scope.loaderForm=false;});}}
$scope.delete=function(dataItem){if(AuthService.checkDelete("componente-contato")&&AuthService.checkDelete("componentes")){if(confirm("Deseja deletar esse(s) registro(s)?")){var ids=[];var type="single";var id=dataItem.id;if(dataItem=="multiple"){if($(".itemGrid:checked").length==0){alert("Nenhum item marcado.");return false;}
$(".itemGrid:checked").map(function(key,value){ids.push(value.value);});type="multiple";id=ids[0];}
var request=$resource("/admin/componentes/contatos");$scope.loaderForm=true;request.delete({id:id,ids:[ids],type:type,_token:CSRF_TOKEN},function(response){switch(response.status){case 2:alert(response.data);$scope.loaderForm=false;break;default:if(type=="multiple"){displayMessagesArray(response.data);}else{alert(response.data);}
$scope.grid.dataSource.read();$scope.loaderForm=false;break;}},function(response){alert("Error: "+response.data);$scope.loaderForm=false;});}}}
displayMessagesArray=function(data){var messages="";angular.forEach(data,function(value,key){messages+=value+"\n";});alert(messages);}
displayErrors=function(errors){var messages="";angular.forEach(errors,function(value,key){if(value.length>1){angular.forEach(value,function(value,key){messages+=value+"\n";});}else{messages+=value+"\n";}});alert(messages);$scope.loaderForm=false;}
optionsGrid=function(){return $scope.optionsGrid={dataSource:{type:"json",transport:{read:'/admin/componentes/contatos/grid'},serpageSize:10,serverPaging:true,serverFiltering:true,serverSorting:true,schema:{data:"data",total:"total",model:{id:"id",fields:{id:{type:"number"}}}}},sortable:true,reorderable:true,resizable:true,mobile:true,selectable:true,groupable:{messages:{empty:"Arraste uma coluna para agrupar"}},pageable:{refresh:true,pageSize:10,pageSizes:true,messages:{display:"{0} - {1} de {2} itens",empty:"Não Existem Itens para mostrar",page:"Página",of:"de {0}",itemsPerPage:"itens por Página",first:"Primeira Página",previous:"Página Anterior",next:"Próxima Página",last:"Última Página",refresh:"Atualizar",}},filterable:{extra:true,messages:{clear:"Limpar",filter:"buscar",info:"Registros que:",and:"e",or:"ou",selectValue:"Selecione",},operators:{string:{startswith:"Começa com",endswith:"Termina com",eq:"Seja igual a",neq:"Não é igual a",contains:"Contém",doesnotcontain:"Não contém",},date:{eq:"Igual a",gte:"Maior ou igual a",gt:"Maior que",lte:"Menor ou igual a",lt:"Menor que"},number:{eq:"Igual a",gte:"Maior ou igual a",gt:"Maior que",lte:"Menor ou igual a",lt:"Menor que"},enums:{eq:"Seja igual a",neq:"Não é igual a"}}},toolbar:[{template:"<button class='k-button' ng-disabled='access_create == false' ng-click='window.new()'><span class='k-icon k-i-plus' style='padding:0 2px 0 0;'></span></button>"},{template:"<button class='k-button' ng-click='delete(\"multiple\")'><span class='k-icon k-i-close' style='padding:0 2px 0 0;'></span></button>"}],columns:[{title:"<input type='checkbox' ng-model='checkAll' />",width:"30px",template:"<input type='checkbox' class='itemGrid' ng-model='itensGrid' ng-value='dataItem.id' ng-checked='checkAll'/>",filterable:false,sortable:false},{field:"id",title:"Id",type:"number",width:"50px"},{field:"titulo",title:"Titulo",type:"string"},{command:[{template:"<button class=\'k-button\'  ng-click=\'window.edit(dataItem)\'><span class='k-icon k-i-pencil' style='padding:0 2px 0 0;'></span></button>"},{template:"<button  class=\'k-button\'  ng-click=\'delete(dataItem)\'><span class='k-icon k-i-close' style='padding:0 2px 0 0;'></span></button>"}]}]}}
optionsModal=function(){$scope.conf_modal={title:'Contato',width:'1000',height:'500',actions:["Minimize","Maximize","Close"],visible:false,modal:true,resizable:true,animation:{close:{duration:200},open:{duration:200}}}}
optionsCombo=function(){$scope.comboPosicao={filter:'contains',dataTextField:"descricao",dataValueField:"id",dataSource:{transport:{read:{url:"/admin/modulo-posicaos/combo",async:false}}},change:function(e){var data=this.dataSource.data();var input=this.value();var search=false;angular.forEach(data,function(v,key){if(v.id==input){search=true;}});if(search==false){this.value("");}}}
$scope.comboMostrarTitulo={filter:'contains',dataTextField:"text",dataValueField:"value",autoBind:false,dataSource:{data:[{text:"Não",value:false},{text:"Sim",value:true}]}}
$scope.comboTagTitulo={filter:'contains',dataTextField:"v",dataValueField:"v",autoBind:false,dataSource:{data:[{v:"h1"},{v:"h2"},{v:"h3"},{v:"h4"},{v:"h5"},{v:"h6"}]}}
$scope.comboBanner={filter:'contains',dataTextField:"descricao",dataValueField:"id",dataSource:{transport:{read:{url:"/admin/componentes/contatos/banner-sliders/combo",async:false}}},change:function(e){var data=this.dataSource.data();var input=this.value();var search=false;angular.forEach(data,function(v,key){if(v.id==input){search=true;}});if(search==false){this.value("");}}}}
init=function(){AuthService.checkView("componentes");AuthService.checkView("componente-contato");optionsModal();optionsGrid();}
init();});$app.controller('BannerSlidersController',function($scope,$http,$window,$location,$resource,AuthService,CSRF_TOKEN){$scope.title="Banner Slider";$scope.content="banner";$scope.window={new:function(){$scope.dataItem={descricao:""};$scope.formView="new";$scope.formAction="create()";$scope.modal.setOptions({title:"Adicionar Banner"});$scope.modal.open().center();},edit:function(dataItem){$scope.formView="edit";$scope.formAction="update()";$scope.modal.setOptions({title:"Editar Banner: "+dataItem.id});$scope.modal.open().center();$scope.dataItem=dataItem;},close:function(){$scope.modal.close();}}
$scope.executeAction=function(action){switch(action){case"create()":createBanner();break;case"update()":updateBanner();break;}}
createBanner=function(){if(AuthService.checkCreate("componente-banner-slider")&&AuthService.checkCreate("componentes")){var request=$resource("/admin/componentes/banner-sliders",{_token:CSRF_TOKEN});$scope.loaderForm=true;request.save($scope.dataItem,function(response){switch(response.status){case 0:$scope.loaderForm=false;return displayErrors(response.data);break;case 1:alert(response.data);$scope.dataItem={descricao:""};$scope.grid.dataSource.read();$scope.loaderForm=false;break;case 2:alert(response.data);$scope.loaderForm=false;break;}},function(response){$scope.loaderForm=false;});}}
updateBanner=function(){if(AuthService.checkUpdate("componente-banner-slider")&&AuthService.checkUpdate("componentes")){var user=$resource("/admin/componentes/banner-sliders",{_token:CSRF_TOKEN},{update:{method:"PUT"}});$scope.loaderForm=true;user.update($scope.dataItem,function(response){switch(response.status){case 0:return displayErrors(response.data);break;case 1:alert(response.data);$scope.grid.dataSource.read();$scope.loaderForm=false;break;case 2:alert(response.data);$scope.loaderForm=false;break;}},function(response){$scope.loaderForm=false;});}}
$scope.delete=function(dataItem){if(AuthService.checkDelete("componente-banner-slider")&&AuthService.checkDelete("componentes")){if(confirm("Deseja deletar esse(s) registro(s)?")){var ids=[];var type="single";var id=dataItem.id;if(dataItem=="multiple"){if($(".itemGrid:checked").length==0){alert("Nenhum item marcado.");return false;}
$(".itemGrid:checked").map(function(key,value){ids.push(value.value);});type="multiple";id=ids[0];}
var user=$resource("/admin/componentes/banner-sliders");$scope.loaderForm=true;user.delete({id:id,ids:[ids],type:type,_token:CSRF_TOKEN},function(response){switch(response.status){case 2:alert(response.data);$scope.loaderForm=false;break;default:if(type=="multiple"){displayMessagesArray(response.data);}else{alert(response.data);}
$scope.grid.dataSource.read();$scope.loaderForm=false;break;}},function(response){alert("Error: "+response.data);$scope.loaderForm=false;});}}}
displayMessagesArray=function(data){var messages="";angular.forEach(data,function(value,key){messages+=value+"\n";});alert(messages);}
displayErrors=function(errors){var messages="";angular.forEach(errors,function(value,key){if(value.length>1){angular.forEach(value,function(value,key){messages+=value+"\n";});}else{messages+=value+"\n";}});alert(messages);$scope.loaderForm=false;}
optionsGrid=function(){return $scope.optionsGrid={dataSource:{type:"json",transport:{read:'/admin/componentes/banner-sliders/grid'},serpageSize:10,serverPaging:true,serverFiltering:true,serverSorting:true,schema:{data:"data",total:"total",model:{id:"id",fields:{id:{type:"number"}}}}},sortable:true,reorderable:true,resizable:true,mobile:true,selectable:true,groupable:{messages:{empty:"Arraste uma coluna para agrupar"}},pageable:{refresh:true,pageSize:10,pageSizes:true,messages:{display:"{0} - {1} de {2} itens",empty:"Não Existem Itens para mostrar",page:"Página",of:"de {0}",itemsPerPage:"itens por Página",first:"Primeira Página",previous:"Página Anterior",next:"Próxima Página",last:"Última Página",refresh:"Atualizar",}},filterable:{extra:true,messages:{clear:"Limpar",filter:"buscar",info:"Registros que:",and:"e",or:"ou",selectValue:"Selecione",},operators:{string:{startswith:"Começa com",endswith:"Termina com",eq:"Seja igual a",neq:"Não é igual a",contains:"Contém",doesnotcontain:"Não contém",},date:{eq:"Igual a",gte:"Maior ou igual a",gt:"Maior que",lte:"Menor ou igual a",lt:"Menor que"},number:{eq:"Igual a",gte:"Maior ou igual a",gt:"Maior que",lte:"Menor ou igual a",lt:"Menor que"},enums:{eq:"Seja igual a",neq:"Não é igual a"}}},toolbar:[{template:"<button class='k-button' ng-disabled='access_create == false' ng-click='window.new()'><span class='k-icon k-i-plus' style='padding:0 2px 0 0;'></span></button>"},{template:"<button class='k-button' ng-click='delete(\"multiple\")'><span class='k-icon k-i-close' style='padding:0 2px 0 0;'></span></button>"}],columns:[{title:"<input type='checkbox' ng-model='checkAll' />",width:"30px",template:"<input type='checkbox' class='itemGrid' ng-model='itensGrid' ng-value='dataItem.id' ng-checked='checkAll'/>",filterable:false,sortable:false},{field:"id",title:"Id",type:"number",width:"50px"},{field:"descricao",title:"Descrição",type:"string"},{command:[{template:"<button class=\'k-button\'  ng-click=\'window.edit(dataItem)\'><span class='k-icon k-i-pencil' style='padding:0 2px 0 0;'></span></button>"},{template:"<button  class=\'k-button\'  ng-click=\'delete(dataItem)\'><span class='k-icon k-i-close' style='padding:0 2px 0 0;'></span></button>"},{template:"<button  class=\'k-button\'  ng-click=\'setContent(\"imagens\",dataItem)\'><span class='k-icon' style='padding:0 2px 0 0;'></span>Imagens</button>"}]}]}}
optionsModal=function(){$scope.conf_modal={title:'Banner Slider',width:'400',height:'200',actions:["Minimize","Maximize","Close"],visible:false,modal:true,resizable:true,animation:{close:{duration:200},open:{duration:200}}}}
$scope.setContent=function(content,dataItem){$scope.content=content;$scope.itemSelected=dataItem;if(content=='imagens'){$scope.title="Banner: "+dataItem.descricao;}else{$scope.title="Banner Slider";}}
init=function(){AuthService.checkView("componentes");AuthService.checkView("componente-banner-slider");optionsGrid();optionsModal();}
init();});$app.controller("BannerSliderFotosController",function($scope,$rootScope,$resource,AuthService,FileService,CSRF_TOKEN){$scope.title="FOTOS";$scope.openOrdem=false;$scope.files=[];$scope.window={new:function(){var combo=$("#comboImagem").data("kendoComboBox");$rootScope.fileImagesService=combo.dataSource.data();$scope.dataItem={titulo:"",alt:"",legenda:"",imagem:"",publicado:true,url:"",url_target:"_self",banner_slider_id:$scope.banner.id};$scope.formView="new";$scope.formAction="create()";$scope.modal.setOptions({title:"Adicionar Fotos"});$scope.modalFotos.open().center();},edit:function(dataItem){var combo=$("#comboImagem").data("kendoComboBox");$rootScope.fileImagesService=combo.dataSource.data();$scope.formView="edit";$scope.formAction="update()";$scope.modal.setOptions({title:"Editar Artigo: "+dataItem.id});$scope.modalFotos.open().center();$scope.dataItem=dataItem;},close:function(){$scope.modalFotos.close();},ordem:function(){$scope.paramsOrdem={banner_slider_id:$scope.banner.id};$scope.openOrdem=true;$scope.modalOrdem.open().center();},close_ordem:function(){$scope.modalOrdem.close();}}
$scope.executeAction=function(action){switch(action){case"create()":create();break;case"update()":update();break;}}
create=function(){if(AuthService.checkCreate("componente-banner-slider")&&AuthService.checkCreate("componentes")){var user=$resource("/admin/componentes/banner-slider-fotos",{_token:CSRF_TOKEN});$scope.loaderForm=true;user.save($scope.dataItem,function(response){switch(response.status){case 0:return displayErrors(response.data);break;case 1:alert(response.data);$scope.dataItem={titulo:"",alt:"",legenda:"",imagem:"",publicado:true,banner_slide_id:$scope.banner.id};$scope.grid.dataSource.read();$scope.loaderForm=false;break;case 2:alert(response.data);$scope.loaderForm=false;break;}},function(response){$scope.loaderForm=false;});}}
update=function(){if(AuthService.checkUpdate("componente-banner-slider")&&AuthService.checkUpdate("componentes")){var request=$resource("/admin/componentes/banner-slider-fotos",{_token:CSRF_TOKEN},{update:{method:"PUT"}});$scope.loaderForm=true;request.update($scope.dataItem,function(response){switch(response.status){case 0:return displayErrors(response.data);break;case 1:alert(response.data);$scope.grid.dataSource.read();$scope.loaderForm=false;break;case 2:alert(response.data);$scope.loaderForm=false;break;}},function(response){$scope.loaderForm=false;});}}
$scope.delete=function(dataItem){if(AuthService.checkDelete("componente-banner-slider")&&AuthService.checkDelete("componentes")){if(confirm("Deseja deletar esse(s) registro(s)?")){var ids=[];var type="single";var id=dataItem.id;if(dataItem=="multiple"){if($(".itemGrid:checked").length==0){alert("Nenhum item marcado.");return false;}
$(".itemGrid:checked").map(function(key,value){ids.push(value.value);});type="multiple";id=ids[0];}
var user=$resource("/admin/componentes/banner-slider-fotos");$scope.loaderForm=true;user.delete({id:id,ids:[ids],type:type,_token:CSRF_TOKEN},function(response){switch(response.status){case 2:alert(response.data);$scope.loaderForm=false;break;default:if(type=="multiple"){displayMessagesArray(response.data);}else{alert(response.data);}
$scope.grid.dataSource.read();$scope.loaderForm=false;break;}},function(response){alert("Error: "+response.data);$scope.loaderForm=false;});}}}
displayMessagesArray=function(data){var messages="";angular.forEach(data,function(value,key){messages+=value+"\n";});alert(messages);}
displayErrors=function(errors){var messages="";angular.forEach(errors,function(value,key){if(value.length>1){angular.forEach(value,function(value,key){messages+=value+"\n";});}else{messages+=value+"\n";}});alert(messages);$scope.loaderForm=false;}
$scope.optionsGrid=function(dataItem){$scope.banner=dataItem;optionsCombo(dataItem);return{dataSource:{type:"json",transport:{read:'/admin/componentes/banner-slider-fotos/grid?banner_slider_id='+dataItem.id},serpageSize:10,serverPaging:true,serverFiltering:true,serverSorting:true,schema:{data:"data",total:"total",model:{id:"id",fields:{id:{type:"number"}}}}},sortable:true,reorderable:true,resizable:true,mobile:true,selectable:true,groupable:{messages:{empty:"Arraste uma coluna para agrupar"}},pageable:{refresh:true,pageSize:10,pageSizes:true,messages:{display:"{0} - {1} de {2} itens",empty:"Não Existem Itens para mostrar",page:"Página",of:"de {0}",itemsPerPage:"itens por Página",first:"Primeira Página",previous:"Página Anterior",next:"Próxima Página",last:"Última Página",refresh:"Atualizar",}},filterable:{extra:true,messages:{clear:"Limpar",filter:"buscar",info:"Registros que:",and:"e",or:"ou",selectValue:"Selecione",},operators:{string:{startswith:"Começa com",endswith:"Termina com",eq:"Seja igual a",neq:"Não é igual a",contains:"Contém",doesnotcontain:"Não contém",},date:{eq:"Igual a",gte:"Maior ou igual a",gt:"Maior que",lte:"Menor ou igual a",lt:"Menor que"},number:{eq:"Igual a",gte:"Maior ou igual a",gt:"Maior que",lte:"Menor ou igual a",lt:"Menor que"},enums:{eq:"Seja igual a",neq:"Não é igual a"}}},toolbar:[{template:"<button class='k-button' ng-disabled='access_create == false' ng-click='window.new()'><span class='k-icon k-i-plus' style='padding:0 2px 0 0;'></span></button>"},{template:"<button class='k-button' ng-click='delete(\"multiple\")'><span class='k-icon k-i-close' style='padding:0 2px 0 0;'></span></button>"},{template:"<button class='k-button' ng-click='$parent.setContent(\"banner\")'>Voltar</button>"},{template:"<button class='k-button' ng-click='window.ordem()'>Ordem</button>"}],columns:[{title:"<input type='checkbox' ng-model='checkAll' />",width:"30px",template:"<input type='checkbox' class='itemGrid' ng-model='itensGrid' ng-value='dataItem.id' ng-checked='checkAll'/>",filterable:false,sortable:false},{field:"id",title:"Id",type:"number",width:"50px"},{field:"imagem",title:"Imagem",type:"string",template:"<img src='/componentes/banner-slider/banner-#=banner_slider_id#/#=imagem#' width='100px;'>",},{field:"titulo",title:"Titulo",type:"string"},{command:[{template:"<button class=\'k-button\'  ng-click=\'window.edit(dataItem)\'><span class='k-icon k-i-pencil' style='padding:0 2px 0 0;'></span></button>"},{template:"<button  class=\'k-button\'  ng-click=\'delete(dataItem)\'><span class='k-icon k-i-close' style='padding:0 2px 0 0;'></span></button>"}]}]}}
$scope.changeFiles=function(file){FileService.setFile(file[0]);}
$scope.uploadFiles=function(file){var path='componentes/banner-slider/banner-'+$scope.banner.id;FileService.setPath(path);FileService.uploadFiles({refreshCombo:true});}
$scope.deleteFile=function(index){FileService.set
FileService.deleteFile(index);}
$scope.updateOrdem=function(){$(".status-ordem-modulo").addClass('btn-primary').html("<span>Alterando Ordem...</span>");var request=$resource('/admin/componentes/banner-slider-fotos/ordem',{_token:CSRF_TOKEN},{update:{method:"PUT"}});if($rootScope.itensOrdemSortable==""){$(".status-ordem-modulo").removeClass('primary bt-danger').addClass('btn-success').html("<span>Ordem atualizada</span>");}else{$(".status-ordem-modulo").removeClass('btn-success bt-danger').addClass('btn-primary').html("<span>Alterando Ordem</span>");request.update({itens:$rootScope.itensOrdemSortable},function(response){$(".status-ordem-modulo").removeClass('primary bt-danger').addClass('btn-success').html("<span>Ordem atualizada</span>");},function(response){alert('error');})}}
optionsModal=function(){$scope.conf_modal={title:'Fotos',width:'900',height:'450',actions:["Minimize","Maximize","Close"],visible:false,modal:true,resizable:true,animation:{close:{duration:200},open:{duration:200}}}
$scope.conf_modal_ordem={title:'Ordem Fotos',width:'400',height:'500',actions:["Minimize","Maximize","Close"],visible:false,modal:true,resizable:true,animation:{close:{duration:200},open:{duration:200}},close:function(){$scope.openOrdem=false;$scope.$apply();}}}
optionsCombo=function(dataItem){$scope.comboImagem={filter:'contains',dataTextField:"text",dataValueField:"value",dataSource:{transport:{read:{url:"/admin/files/read_dir?pasta=componentes/banner-slider/banner-"+dataItem.id,async:false}}},template:"<img src='/componentes/banner-slider/banner-"+dataItem.id+"/#=value#' width='100px;'>",change:function(e){var data=this.dataSource.data();var input=this.value();var search=false;angular.forEach(data,function(v,key){if(v.value==input){search=true;}});if(search==false){this.value("");}}}
$scope.comboTarget={filter:'contains',dataTextField:"text",dataValueField:"value",autoBind:false,dataSource:{data:[{text:"Nova Janela",value:"_blank"},{text:"Mesma Janela",value:"_self"}]}}}
init=function(){optionsModal();}
init();});$app.controller('UsuariosController',function($scope,$http,$window,$location,$resource,MenuService,AuthService,CSRF_TOKEN){$scope.title="Usuários";$scope.window={new:function(){$scope.dataItem={nome:"",nome_usuario:"",email:"",senha:"",ativo:true,permissoes:""};$scope.dataItem.permissoes=getDefaultPermissoes();$scope.formView="new";$scope.formAction="create()";$scope.modal.setOptions({title:"Adicionar Usuário"});$scope.modal.open().center();},edit:function(dataItem){dataItem.senha="";$scope.formView="edit";$scope.formAction="update()";$scope.modal.setOptions({title:"Editar Úsuario: "+dataItem.id});$scope.modal.open().center();$scope.dataItem=dataItem;$scope.dataItem.permissoes=verificaChangePermissoes(dataItem.permissoes);},close:function(){$scope.modal.close();}}
$scope.executeAction=function(action){switch(action){case"create()":create();break;case"update()":update();break;}}
create=function(){if(AuthService.checkCreate("usuarios")){var user=$resource("/admin/usuarios",{_token:CSRF_TOKEN});$scope.loaderForm=true;user.save($scope.dataItem,function(response){switch(response.status){case 0:return displayErrors(response.data);break;case 1:alert(response.data);$scope.dataItem={nome:"",nome_usuario:"",email:"",senha:"",ativo:true,tipo:0,permissoes:getDefaultPermissoes(),cliente_id:""};$scope.grid.dataSource.read();$scope.loaderForm=false;break;case 2:alert(response.data);$scope.loaderForm=false;break;}},function(response){$scope.loaderForm=false;});}}
update=function(){if(AuthService.checkUpdate("usuarios")){var user=$resource("/admin/usuarios",{_token:CSRF_TOKEN},{update:{method:"PUT"}});$scope.loaderForm=true;user.update($scope.dataItem,function(response){switch(response.status){case 0:return displayErrors(response.data);break;case 1:alert(response.data);$scope.grid.dataSource.read();$scope.loaderForm=false;break;case 2:alert(response.data);$scope.loaderForm=false;break;}},function(response){$scope.loaderForm=false;});}}
$scope.delete=function(dataItem){if(AuthService.checkDelete("usuarios")){if(confirm("Deseja deletar esse(s) registro(s)?")){var ids=[];var type="single";var id=dataItem.id;if(dataItem=="multiple"){if($(".itemGrid:checked").length==0){alert("Nenhum item marcado.");return false;}
$(".itemGrid:checked").map(function(key,value){ids.push(value.value);});type="multiple";id=ids[0];}
var user=$resource("/admin/usuarios");$scope.loaderForm=true;user.delete({id:id,ids:[ids],type:type,_token:CSRF_TOKEN},function(response){switch(response.status){case 2:alert(response.data);$scope.loaderForm=false;break;default:if(type=="multiple"){displayMessagesArray(response.data);}else{alert(response.data);}
$scope.grid.dataSource.read();$scope.loaderForm=false;break;}},function(response){alert("Error: "+response.data);$scope.loaderForm=false;});}}}
displayMessagesArray=function(data){var messages="";angular.forEach(data,function(value,key){messages+=value+"\n";});alert(messages);}
displayErrors=function(errors){var messages="";angular.forEach(errors,function(value,key){if(value.length>1){angular.forEach(value,function(value,key){messages+=value+"\n";});}else{messages+=value+"\n";}});alert(messages);$scope.loaderForm=false;}
optionsGrid=function(){return $scope.optionsGrid={dataSource:{type:"json",transport:{read:'/admin/usuarios/grid'},serpageSize:10,serverPaging:true,serverFiltering:true,serverSorting:true,schema:{data:"data",total:"total",model:{id:"id",fields:{id:{type:"number"}}}}},sortable:true,reorderable:true,resizable:true,mobile:true,selectable:true,groupable:{messages:{empty:"Arraste uma coluna para agrupar"}},pageable:{refresh:true,pageSize:10,pageSizes:true,messages:{display:"{0} - {1} de {2} itens",empty:"Não Existem Itens para mostrar",page:"Página",of:"de {0}",itemsPerPage:"itens por Página",first:"Primeira Página",previous:"Página Anterior",next:"Próxima Página",last:"Última Página",refresh:"Atualizar",}},filterable:{extra:true,messages:{clear:"Limpar",filter:"buscar",info:"Registros que:",and:"e",or:"ou",selectValue:"Selecione",},operators:{string:{startswith:"Começa com",endswith:"Termina com",eq:"Seja igual a",neq:"Não é igual a",contains:"Contém",doesnotcontain:"Não contém",},date:{eq:"Igual a",gte:"Maior ou igual a",gt:"Maior que",lte:"Menor ou igual a",lt:"Menor que"},number:{eq:"Igual a",gte:"Maior ou igual a",gt:"Maior que",lte:"Menor ou igual a",lt:"Menor que"},enums:{eq:"Seja igual a",neq:"Não é igual a"}}},toolbar:[{template:"<button class='k-button' ng-disabled='access_create == false' ng-click='window.new()'><span class='k-icon k-i-plus' style='padding:0 2px 0 0;'></span></button>"},{template:"<button class='k-button' ng-click='delete(\"multiple\")'><span class='k-icon k-i-close' style='padding:0 2px 0 0;'></span></button>"}],columns:[{title:"<input type='checkbox' ng-model='checkAll' />",width:"30px",template:"<input type='checkbox' class='itemGrid' ng-model='itensGrid' ng-value='dataItem.id' ng-checked='checkAll'/>",filterable:false,sortable:false},{field:"id",title:"Id",type:"number",width:"50px"},{field:"nome",title:"Nome",type:"text"},{field:"nome_usuario",title:"Usuário",type:"text"},{field:"email",title:"Email",type:"text"},{command:[{template:"<button class=\'k-button\' ng-disabled='access_update == false' ng-click=\'window.edit(dataItem)\'><span class='k-icon k-i-pencil' style='padding:0 2px 0 0;'></span></button>"},{template:"<button  class=\'k-button\' ng-disabled='access_destroy == false' ng-click=\'delete(dataItem)\'><span class='k-icon k-i-close' style='padding:0 2px 0 0;'></span></button>"}]}]}}
optionsModal=function(){$scope.conf_modal={title:'Usuários',width:'800',height:'500',actions:["Minimize","Maximize","Close"],visible:false,modal:true,resizable:true,animation:{close:{duration:200},open:{duration:200}}}}
contemInPermissoes=function(apelido,permissoes){var data={resp:false,item:[]};if(data.resp==false){angular.forEach(permissoes,function(value,key){if(apelido==value.nome){data.resp=true;data.item=value;}
if(value.itemParent==true){angular.forEach(value.itens,function(value,key){if(apelido==value.nome){data.resp=true;data.item=value;}});}});}
return data;}
verificaChangePermissoes=function(permissoes){var menu=MenuService.getMenu();var permissoes=angular.fromJson(permissoes);var permissoesOut=[];angular.forEach(menu,function(value,key){var data=contemInPermissoes(value.apelido,permissoes);if(data.resp){var item=data.item;permissoesOut.push(item);}else{var item={display:value.display,nome:value.apelido,view:false,delete:false,create:false,update:false};permissoesOut.push(item);}
if(value.itemParent==true){angular.forEach(value.itens,function(value,key){var data=contemInPermissoes(value.apelido,permissoes);if(data.resp){var item=data.item;permissoesOut.push(item);}else{var item={display:value.display,nome:value.apelido,view:false,delete:false,create:false,update:false};permissoesOut.push(item);}});}});return permissoesOut;}
getDefaultPermissoes=function(){var permissoes=[];var menu=MenuService.getMenu();angular.forEach(menu,function(value,key){var item={display:value.display,nome:value.apelido,view:true,delete:true,create:true,update:true};permissoes.push(item);if(value.itemParent==true){angular.forEach(value.itens,function(value,key){var item={display:value.display,nome:value.apelido,view:true,delete:true,create:true,update:true};permissoes.push(item);});}});return permissoes;}
init=function(){AuthService.checkView("usuarios");optionsGrid();optionsModal();}
init();});$app.controller('SiteConfigController',function($scope,$resource,CSRF_TOKEN,AuthService){$scope.title="Configuração Global";$scope.save=function(){if(AuthService.checkUpdate("configuracao-global")){$scope.loaderForm=true;var request=$resource("/admin/site-configs",{_token:CSRF_TOKEN},{update:{method:"PUT"}});$scope.loaderForm=true;request.update($scope.dataItem,function(response){switch(response.status){case 0:return displayErrors(response.data);break;case 1:alert(response.data);$scope.loaderForm=false;break;case 2:alert(response.data);$scope.loaderForm=false;break;}},function(response){$scope.loaderForm=false;});}}
displayMessagesArray=function(data){var messages="";angular.forEach(data,function(value,key){messages+=value+"\n";});alert(messages);}
displayErrors=function(errors){var messages="";angular.forEach(errors,function(value,key){if(value.length>1){angular.forEach(value,function(value,key){messages+=value+"\n";});}else{messages+=value+"\n";}});alert(messages);$scope.loaderForm=false;}
optionsCombo=function(){$scope.comboSeguranca={filter:'contains',dataTextField:"text",dataValueField:"value",dataBind:false,dataSource:{data:[{text:"SSL",value:1},{text:"TSL",value:2}]}}}
getConfig=function(){var request=$resource('/admin/site-configs/get');request.get(function(response){$scope.dataItem=response;})}
init=function(){AuthService.checkView("configuracao-global");optionsCombo();getConfig();}
init();});$app.controller('LogsController',function($scope,$resource,AuthService,$sce){$scope.title='Logs';$scope.window={detalhe:function(dataItem){$scope.dataItem=dataItem;$scope.data_log=formatDateTime(dataItem.created_at);$scope.valor_novo=dataItem.valor_novo;$scope.valor_antigo=dataItem.valor_antigo;$scope.dataObservacoes=JSON.parse(dataItem.observacoes);$scope.observacoes=[];angular.forEach($scope.dataObservacoes,function(value,key){var i=key;var v=value.toString();if(key=="permissoes"){v=formatPermissoes(value);}
if(key!="updated_at"&&key!="created_at"){$scope.observacoes.push({index:i,valor:v});}});checkTableUsuarios(dataItem);$scope.modal.setOptions({title:"Log "+dataItem.id});$scope.modal.open().center();},close:function(){$scope.modal.close();}}
checkTableUsuarios=function(data){if(data.tabela=="usuarios"&&data.acao=="update"&&data.campo=="permissoes"){$scope.valor_antigo=formatPermissoes(data.valor_antigo);$scope.valor_novo=formatPermissoes(data.valor_novo);}}
formatDateTime=function(date){var data=date.substring(0,10).split('-');var hora=date.substring(11,19);return data[2]+"/"+data[1]+"/"+data[0]+" - "+hora;}
formatPermissoes=function(permissoes){var data=JSON.parse(permissoes);var html="";var view="";var create="";var update="";var destroy="";angular.forEach(data,function(value,key){view=value.view==true?"<span class='icon icon-checkmark'></span>":"<span class='icon icon-cancel'></span>";create=value.create==true?"<span class='icon icon-checkmark'></span>":"<span class='icon icon-cancel'></span>";update=value.update==true?"<span class='icon icon-checkmark'></span>":"<span class='icon icon-cancel'></span>";destroy=value.delete==true?"<span class='icon icon-checkmark'></span>":"<span class='icon icon-cancel'></span>";html+="<strong>"+value.display+"</strong><br>";html+=" View: "+view;html+=" Create: "+create;html+=" Update: "+update;html+=" Delete: "+destroy+"<br>";});return html;}
optionsGrid=function(){return $scope.optionsGrid={dataSource:{type:"json",transport:{read:'/admin/logs/grid'},serpageSize:10,serverPaging:true,serverFiltering:true,serverSorting:true,schema:{data:"data",total:"total",model:{id:"id",fields:{id:{type:"number"}}}}},sortable:true,reorderable:true,resizable:true,mobile:true,selectable:true,groupable:{messages:{empty:"Arraste uma coluna para agrupar"}},pageable:{refresh:true,pageSize:10,pageSizes:true,messages:{display:"{0} - {1} de {2} itens",empty:"Não Existem Itens para mostrar",page:"Página",of:"de {0}",itemsPerPage:"itens por Página",first:"Primeira Página",previous:"Página Anterior",next:"Próxima Página",last:"Última Página",refresh:"Atualizar",}},filterable:{extra:true,messages:{clear:"Limpar",filter:"buscar",info:"Registros que:",and:"e",or:"ou",selectValue:"Selecione",},operators:{string:{startswith:"Começa com",endswith:"Termina com",eq:"Seja igual a",neq:"Não é igual a",contains:"Contém",doesnotcontain:"Não contém",},date:{eq:"Igual a",gte:"Maior ou igual a",gt:"Maior que",lte:"Menor ou igual a",lt:"Menor que"},number:{eq:"Igual a",gte:"Maior ou igual a",gt:"Maior que",lte:"Menor ou igual a",lt:"Menor que"},enums:{eq:"Seja igual a",neq:"Não é igual a"}}},tolbar:[],columns:[{field:"id",title:"Id",type:"number",width:"50px"},{field:"nome_usuario",title:"Nome Usuário",type:"text"},{field:"tabela",title:"Tabela",type:"text"},{field:"acao",title:"Ação",type:"text"},{command:[{template:"<button class=\'k-button\' ng-disabled='' ng-click=\'window.detalhe(dataItem)\'><span class='icon-eye-2' style='padding:0 2px 0 0;'></span></button>"},]}]}}
optionsModal=function(){$scope.conf_modal={title:'Log',width:'800',height:'500',actions:["Minimize","Maximize","Close"],visible:false,modal:true,resizable:true,animation:{close:{duration:200},open:{duration:200}}}}
init=function(){AuthService.checkView("logs");optionsGrid();optionsModal();}
init();});$app.controller('HomeController',function($scope,$http,$window,$location,$resource,AuthService){$scope.title="Home";init=function(){AuthService.checkView("home");}
init();});$app.controller("AuthController",function($scope,$rootScope,$resource,CSRF_TOKEN,$timeout,AuthService,$location){$scope.title="Login";$scope.loaderLogin=false;$scope.displayRespLogin=false;$scope.user={nome_usuario:"",senha:""};$scope.login=function(){$scope.loaderLogin=true;var user=$resource('/admin/auth/login',{_token:CSRF_TOKEN},{post:{method:"POST"}});user.post($scope.user,function(response){if(response.status==0){$scope.loaderLogin=false;readErrors(response.data);}else{var user=response.data;AuthService.setLogin(user);AuthService.setPermissoes(user[0].permissoes);$location.path("/admin");}},function(response){$scope.respLogin="Erro no servidor.";$scope.loaderLogin=false;$scope.displayRespLogin=true;});}
$scope.logout=function(){var user=$resource('/admin/auth/logout',{_token:CSRF_TOKEN},{post:{method:"POST"}});$scope.loaderLogout=true;user.post(function(response){$(".content-right").attr("style","");$(".page-content").html("");$rootScope.loginUser=false;$rootScope.currentLink="/admin/login";$timeout(function(){$location.path('/admin/login');},500);$scope.loaderLogout=false;},function(response){alert("Erro no Servidor.");$scope.loaderLogout=false;});}
readErrors=function(messages){var data=messages;$scope.respLogin="";angular.forEach(data,function(value,key){$scope.respLogin+=value+"<br>";if(value.length>1){angular.forEach(value,function(value,key){$scope.respLogin+=value+"<br>";});}});$timeout(function(){$scope.displayRespLogin=true;},500);}});