$app.directive('bannerSliderCycle',function(){return{restrict:'A',scope:{parametros:"=parametros"},link:function(scope,element,attrs,model){var options=angular.fromJson(scope.parametros);var img=$(element).parent().find('.cycle-image-first');element.cycle({fx:options.efeito,easing:'easeOutBack',loader:"wait",slides:'.itemCycle',pager:parseInt(options.paginacao)==1?$(element).parent().find("#pager"):null,prev:parseInt(options.prev)==1?$(element).parent().find("#prev"):null,next:parseInt(options.next)==1?$(element).parent().find("#next"):null,timeout:options.timeout,speed:options.speed,pause:parseInt(options.pause),containerResize:0,width:'100%',fit:1,after:function(){},pagerAnchorBuilder:function(idx,slide){if(parseInt(options.paginacao)==1){var src=$(slide).find('img').attr('src');return'<li><a href="#"><img src="'+src+'" width="50" height="50" /></a></li>';}}});$(img).load(function(){element.css({'height':$(this).height()+"px",});});$(window).resize(function(){var img=$(element).parent().find('.cycle-image-first');element.css({'height':img.height()+"px",});});}}});$app.directive('modulo',function($resource,$compile,$rootScope,ModuloService,MODULOS){return{restrict:"E",scope:{posicao:"@posicao",modulo:"@data"},link:function(scope,element,attrs,model){var request=$resource('/CmsModulos/get-modulos-posicao');var data={posicao:scope.posicao};var modulos_all=MODULOS;var modulos=searchModulos(modulos_all,scope.posicao);if(modulos.length>0){angular.forEach(modulos,function(v,k){scope.modulo=v;var m=getModulo(v);var el=angular.element(m);compiled=$compile(el)(scope);element.append(compiled);});}
function searchModulos(data,posicao){var modulos=[];angular.forEach(data,function(v,k){if(v.descricao==posicao){modulos.push(v);}});return modulos;}
function getModulo(modulo){switch(modulo.tipo){case'html':return"<modulo-html data='modulo'></modulo-html>";break;case'banner-slider':return"<modulo-banner-slider data='modulo'></modulo-banner-slider>";break;case'contato':return"<modulo-contato data='modulo'></modulo-contato>";break;case'menu':return"<modulo-menu data='modulo'></modulo-menu>";break;}}}}});$app.directive('moduloHtml',function($compile){return{restrict:"E",scope:{modulo:"=data"},link:function(scope,element,attrs,model){var html="";var data=scope.modulo;var conteudo=data.conteudo;var titulo=data.titulo;var mostrar_titulo=data.mostrar_titulo;var tag_titulo=data.tag_titulo;var parametros=angular.fromJson(data.parametros);html+="<div class='modulo-html "+parametros.class+"' id='"+parametros.id+"'>";if(mostrar_titulo==true){html+="<"+tag_titulo+">"+titulo+"</"+tag_titulo+">";}
html+=conteudo;html+="</div>";var el=angular.element(html);compiled=$compile(el)(scope);element.html(compiled).show('fade');}}});$app.directive('moduloBannerSlider',function($resource,$compile,$http,$q){return{restrict:"E",scope:{modulo:"=data"},link:function(scope,element,attrs,model){var html="";var data=scope.modulo;var titulo=data.titulo;var mostrar_titulo=data.mostrar_titulo;var tag_titulo=data.tag_titulo;var parametros=angular.fromJson(data.parametros);var request=$resource('/CmsModulos/banner-sliders/get-fotos',{banner_id:parametros.banner_id});if(mostrar_titulo==true){html+="<"+tag_titulo+">"+titulo+"</"+tag_titulo+">";}
request.query(function(response){scope.modulo=data;var banner=response;var li="";var image_first="";var altura_inicial="";html+="<section class='"+parametros.class+" banner-slider-cycle' id='"+parametros.id+"'>";html+="<nav banner-slider-cycle parametros='modulo.parametros' class='cycle'>";angular.forEach(banner,function(v,k){var image="/componentes/banner-slider/banner-"+v.banner_slider_id+"/"+v.imagem;if(k==0){image_first="<img src='"+image+"' style='display:none;' class='cycle-image-first'/>"}
if(v.url.length>0){html+="<div class='itemCycle'>";html+="<a href='"+v.url+"' target='"+v.url_target+"'>";html+="<img src='"+image+"'>";if(v.legenda.length>0){html+="<div class='cycle-legenda'><div class='body'>";html+=v.legenda;html+="</div></div>";}
html+="</a>";html+="</div>";}else{html+="<div class='itemCycle'>";html+="<img src='"+image+"'>";if(v.legenda.length>0){html+="<div class='cycle-legenda'><div class='body'>";html+=v.legenda;html+="</div></div>";}
html+="</div>";}
li+="<li><a href='#'><img src='"+image+"' width='50px' /></a></li>";});html+="</nav>";if(parseInt(parametros.next)==1||parseInt(parametros.prev)==1){html+="<div class='clear'></div>";}
if(parseInt(parametros.prev)==1){html+="<div id='prev' class='cycle-prev'><span class='icon-arrow-left-2'></span></div>";}
if(parseInt(parametros.next)==1){html+="<div id='next' class='cycle-next'><span class='icon-arrow-right-2'></span></div>";}
var navs="";if(parseInt(parametros.paginacao)){navs+="<div class='cycle-pager'>";navs+="<ul id='pager'>";navs+="</ul>";navs+="</div>";}
navs+=image_first;navs+="</section>";var el=angular.element(html+navs);compiled=$compile(el)(scope);element.html(compiled).show('fade');},function(response){});}}});$app.directive('moduloContato',function($compile,$resource){return{restrict:"E",scope:{modulo:"=data"},link:function(scope,element,attrs,model){var data=scope.modulo;var titulo=data.titulo;var mostrar_titulo=data.mostrar_titulo;var tag_titulo=data.tag_titulo;var parametros=angular.fromJson(data.parametros);var el=angular.element("<h1>TESTE</h1 >");var compiled=$compile(el)(scope);element.html(compiled);}}});$app.directive('moduloMenu',function($compile,$resource){return{restrict:"E",scope:{modulo:"=data"},link:function(scope,element,attrs,model){var data=scope.modulo;var titulo=data.titulo;var mostrar_titulo=data.mostrar_titulo;var tag_titulo=data.tag_titulo;var parametros=angular.fromJson(data.parametros);var html="";html+="<div class='modulo-menu "+parametros.class+"' id='"+parametros.id+"'>";if(mostrar_titulo==true){html+="<"+tag_titulo+">"+titulo+"</"+tag_titulo+">";}
html+="<modulo-menu-"+parametros.menu_template+" parametros='modulo.parametros'></modulo-menu-"+parametros.menu_template+">";html+="</div>";var el=angular.element(html);var compiled=$compile(el)(scope);element.html(compiled);}}});$app.directive('moduloMenuPadrao',function($compile,$resource,MenuService){return{restrict:"AE",scope:{parametros:"=parametros"},template:"<nav class='modulo-menu-padrao'><ul></ul></nav>",link:function(scope,element,attrs,model){var parametros=angular.fromJson(scope.parametros);var request=$resource('CmsModulos/menus/getMenu');var html="<h1>Menu Padrao</h1>";request.query({menu_id:parametros.menu_id},function(response){var menu_itens=response;var menuHtml="";angular.forEach(menu_itens,function(v,k){if(MenuService.contemItemPai(menu_itens,v.id)){menuHtml+="<li>";menuHtml+="<a href='"+v.apelido+"' title='"+v.titulo+"' class='item-parent' menu-dropdown>";menuHtml+=v.titulo;menuHtml+="<span class='icon icon-arrow-right-2'></span>"
menuHtml+="</a>";menuHtml+="<ul class='sub-itens'>";angular.forEach(v.itens,function(v,k){menuHtml+="<li>";menuHtml+="<a href='"+v.apelido+"' title='"+v.titulo+"' ng-class='{active:currentLink == \""+v.titulo+"\"}'>";menuHtml+=v.titulo;menuHtml+="</a>";menuHtml+="</li>";});menuHtml+="</ul>";menuHtml+="</li>";}else{menuHtml+="<li>";menuHtml+="<a href='"+v.apelido+"' title='"+v.titulo+"' ng-class='{active:currentLink == \""+v.apelido+"\"}'>";menuHtml+=v.titulo;menuHtml+="</a>";menuHtml+="</li>";}});var el=angular.element(menuHtml);var compiled=$compile(el)(scope);element.find('ul').html(compiled);},function(response){element.html("Erro ao carregar menu.");});}}});$app.directive('menuPrincipal',function(MenuService,$compile){return{restrict:"E",template:"<nav class='menu'><ul class='menu-body'></ul></div></nav>",link:function(scope,element,attrs,model){var menu=MenuService.getMenu();var menuHtml="";angular.forEach(menu,function(v,k){if(v.itemParent==false){menuHtml+="<li>";menuHtml+="<a href='"+v.href+"' title='"+v.title+"' ng-class='{active:currentLink == \""+v.href+"\"}'>";menuHtml+=v.display;menuHtml+="</a>";menuHtml+="</li>";}else{menuHtml+="<li>";menuHtml+="<a href='"+v.href+"' title='"+v.title+"' class='item-parent' menu-dropdown>";menuHtml+=v.display;menuHtml+="<span class='icon icon-arrow-right-2'></span>"
menuHtml+="</a>";menuHtml+="<ul class='sub-itens'>";angular.forEach(v.itens,function(v,k){menuHtml+="<li>";menuHtml+="<a href='"+v.href+"' title='"+v.title+"' ng-class='{active:currentLink == \""+v.href+"\"}'>";menuHtml+=v.display;menuHtml+="</a>";menuHtml+="</li>";});menuHtml+="</ul>";menuHtml+="</li>";}});var el=angular.element(menuHtml);compiled=$compile(el)(scope);element.find('ul').html(compiled);}}});